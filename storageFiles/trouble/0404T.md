### 0404T  
---  

- 유니티 멈춤
 - while(true) 중단 조건문이 잘못된 것 같다  
![image](https://github.com/s8st/20240320FinalProject/assets/153998744/56f15ff9-3115-4281-b15c-44ed06b2f912)


```cpp
private  void SpawnMonster()
{
    //while (true)

    while (true)
    {
        if (currentSpawnCount == 0) // 소환되어 있는 객체들의 갯수: 0이라면 처음이거나 다 잡았거나
        {




            GameObject enemy = Instantiate(enemyPrefebs[6], spawnPositionsRoot.position, Quaternion.identity);
            enemy.GetComponent<HealthSystem>().OnDeath += OnEnemyDeath;
            enemy.GetComponent<HealthSystem>().OnDeath += CreateReward;

            //몬스터를 생성할 때 지워줘야
            enemy.GetComponent<CharacterStatsHandler>().AddStatModifier(defaultStats);
            enemy.GetComponent<CharacterStatsHandler>().AddStatModifier(rangedStats);

            currentSpawnCount++;
            //yield return new WaitForSeconds(spawnInterval);

        }
    }
}
```
- 문제점
 - 1번만 몬스터 발생 ---> 코루틴에 while(true)
 - 무한 반복 ---> yield return new WaitForSeconds(spawnInterval); 



 ![image](https://github.com/s8st/20240320FinalProject/assets/153998744/fcd59047-7f0f-401d-8df5-ca80adfc7710)

- 1번 포지션에서만 몬스터가 발생
  - 해결책은 ??
  - for을 삭제했더니 1번만 몬스터가 발생했던 문제

```cpp
 for (int i = 0; i < waveSpawnPosCount; i++)
 {
     int posIdx = Random.Range(0, spawnPostions.Count);
     for (int j = 0; j < waveSpawnCount; j++)
     {
         int prefabIdx = Random.Range(0, enemyPrefebs.Count);
         GameObject enemy = Instantiate(enemyPrefebs[prefabIdx], spawnPostions[posIdx].position, Quaternion.identity);
         enemy.GetComponent<HealthSystem>().OnDeath += OnEnemyDeath;

         //몬스터를 생성할 때 지워줘야
         enemy.GetComponent<CharacterStatsHandler>().AddStatModifier(defaultStats);
         enemy.GetComponent<CharacterStatsHandler>().AddStatModifier(rangedStats);

         currentSpawnCount++;
         yield return new WaitForSeconds(spawnInterval);
     }
 }

```

- 몬스터 생산이 안된다...
![image](https://github.com/s8st/20240320FinalProject/assets/153998744/1e85b7ec-e526-45a7-b186-b93eab75354b)

케릭터 선택창에서 선택한 플레이어가 나오게 만들려고 하이어라키의 플레이어를 모두 DeActive했더니 아래 코드에서 문제라고 한다

`Player = GameObject.FindGameObjectWithTag(playerTag).transform;`

```cpp
 private void Awake()
 {
     instance = this;
     // FindGameObjectWithTag : 태그로 검색, 하이어라키에서 모두 검색하기 때문에 느려진다.
     // 매 프레임 실행하는 Update에서는 사용하지 않는다, 한번만 사용할때
     Player = GameObject.FindGameObjectWithTag(playerTag).transform;

     playerHealthSystem = Player.GetComponent<HealthSystem>();
     playerHealthSystem.OnDamage += UpdateHealthUI;
     playerHealthSystem.OnHeal += UpdateHealthUI;
     playerHealthSystem.OnDeath += GameOver;

     gameOverUI.SetActive(false);

     for (int i = 0; i < spawnPositionsRoot.childCount; i++)
     {
         //spawnPostions을 다 가져와서 저장
         spawnPostions.Add(spawnPositionsRoot.GetChild(i)); // GetChild : transform반환
     }

 }
```





